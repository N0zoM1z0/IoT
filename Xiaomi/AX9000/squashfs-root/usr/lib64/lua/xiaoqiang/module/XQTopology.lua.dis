local L0, L1, L2, L3, L4
L0 = module
L1 = "xiaoqiang.module.XQTopology"
L2 = package
L2 = L2.seeall
L0(L1, L2)
L0 = require
L1 = "cjson"
L0 = L0(L1)
L1 = require
L2 = "xiaoqiang.common.XQFunction"
L1 = L1(L2)
L2 = require
L3 = "xiaoqiang.common.XQConfigs"
L2 = L2(L3)
L3 = require
L4 = "luci.util"
L3 = L3(L4)
function L4(A0)
  local L1, L2, L3, L4, L5, L6, L7, L8, L9, L10, L11, L12, L13
  L1 = {}
  L1.ip = ""
  L2 = A0.router_name
  if not L2 then
    L2 = A0.hostname
    L2 = L2 or L2
  end
  L1.name = L2
  L2 = A0.locale
  L2 = L2 or L2
  L1.locale = L2
  L1.hardware = ""
  L1.channel = ""
  L2 = tonumber
  L3 = A0.is_ap
  L3 = L3 or L3
  L2 = L2(L3)
  L1.mode = L2
  L2 = A0.version
  L2 = L2 or L2
  L1.version = L2
  L1.ssid = ""
  L1.color = 100
  L2 = string
  L2 = L2.lower
  L3 = L1.name
  L2 = L2(L3)
  L3 = L2
  L2 = L2.match
  L4 = "^xiaomirepeater"
  L2 = L2(L3, L4)
  if L2 then
    L1.name = "\229\176\143\231\177\179\228\184\173\231\187\167\229\153\168"
  end
  L2 = A0.description
  function L3(A0)
    local L1, L2
    L1 = _UPVALUE1_
    L1 = L1.decode
    L2 = A0
    L1 = L1(L2)
    _UPVALUE0_ = L1
  end
  L4 = _UPVALUE1_
  L4 = L4.isStrNil
  L4 = L4(L5)
  if not L4 then
    L4 = pcall
    L4 = L4(L5, L6)
    if L4 then
      L4 = L2.hardware
      L1.hardware = L4
      L4 = L2.channel
      L1.channel = L4
      L4 = L2.color
      L1.color = L4
      L4 = L2.ssid
      L1.ssid = L4
      L4 = L2.ip
      L1.ip = L4
      L4 = L2.locale
      L1.locale = L4
    end
  end
  L4 = {}
  if L5 then
    if L5 then
      if 0 < L5 then
        for L9, L10 in L6, L7, L8 do
          L12 = L5
          L11 = L5.match
          L13 = "wl"
          L11 = L11(L12, L13)
          if L11 then
            L12 = L5
            L11 = L5.match
            L13 = "wl"
            L11 = L11(L12, L13)
            if not L11 then
              goto lbl_119
            end
            L11 = tonumber
            L12 = A0.assoc
            L11 = L11(L12)
            if L11 ~= 1 then
              goto lbl_119
            end
          end
          L11 = L10.ageing_timer
          if L11 <= 300 then
            L11 = L10.tx_bytes
            if L11 == 0 then
              L11 = L10.rx_bytes
              if L11 == 0 then
                goto lbl_119
              end
            end
            L11 = L10.ip
            L1.ip = L11
            break
          end
          ::lbl_119::
        end
      end
    end
  end
  if L5 then
    if 0 < L5 then
      for L8, L9 in L5, L6, L7 do
        L10 = L9.is_ap
        if L10 ~= nil then
          L10 = L9.is_ap
          if L10 ~= 0 then
            L10 = table
            L10 = L10.insert
            L11 = L4
            L12 = _recursive
            L13 = L9
            L12, L13 = L12(L13)
            L10(L11, L12, L13)
          end
        end
      end
      if 0 < L5 then
        L1.leafs = L4
      end
    end
  end
  return L1
end
_recursive = L4
function L4()
  local L0, L1, L2, L3, L4, L5, L6, L7, L8, L9, L10, L11, L12, L13, L14, L15, L16
  L0 = require
  L1 = "xiaoqiang.util.XQSysUtil"
  L0 = L0(L1)
  L1 = require
  L2 = "xiaoqiang.util.XQLanWanUtil"
  L1 = L1(L2)
  L2 = require
  L3 = "xiaoqiang.util.XQWifiUtil"
  L2 = L2(L3)
  L3 = L2.getWifiStatus
  L4 = 1
  L3 = L3(L4)
  L3 = L3 or L3
  L4 = "ubus call trafficd hw '{\"tree\":true}'"
  L5 = _UPVALUE0_
  L5 = L5.exec
  L6 = L4
  L5 = L5(L6)
  L6 = {}
  L7 = L1.getLanIp
  L7 = L7()
  L6.ip = L7
  L7 = L0.getRouterName
  L7 = L7()
  L6.name = L7
  L7 = L0.getRouterLocale
  L7 = L7()
  L6.locale = L7
  L7 = L0.getHardware
  L7 = L7()
  L6.hardware = L7
  L7 = L0.getChannel
  L7 = L7()
  L6.channel = L7
  L7 = _UPVALUE1_
  L7 = L7.getNetModeType
  L7 = L7()
  L6.mode = L7
  L7 = L0.getColor
  L7 = L7()
  L6.color = L7
  L7 = L3.ssid
  L7 = L7 or L7
  L6.ssid = L7
  L7 = _UPVALUE1_
  L7 = L7.isStrNil
  L7 = L7(L8)
  if L7 then
    return L6
  else
    L7 = _UPVALUE2_
    L7 = L7.decode
    L7 = L7(L8)
    L5 = L7
  end
  L7 = {}
  for L11, L12 in L8, L9, L10 do
    L13 = L12.is_ap
    if L13 ~= nil then
      L13 = L12.is_ap
      if L13 ~= 0 then
        L13 = L12.assoc
        if L13 ~= 0 then
          L13 = table
          L13 = L13.insert
          L14 = L7
          L15 = _recursive
          L16 = L12
          L15, L16 = L15(L16)
          L13(L14, L15, L16)
        end
      end
    end
  end
  if 0 < L8 then
    L6.leafs = L7
  end
  return L6
end
topologicalGraph = L4
function L4(A0)
  local L1, L2, L3, L4, L5, L6, L7, L8, L9, L10, L11, L12, L13
  L1 = {}
  L2 = _UPVALUE0_
  L2 = L2.macFormat
  L3 = A0.hw
  L2 = L2(L3)
  L1.mac = L2
  L1.mac5G = ""
  L2 = _UPVALUE0_
  L2 = L2.isStrNil
  L3 = A0.description
  L2 = L2(L3)
  if L2 then
    L2 = nil
    return L2
  end
  L2 = pcall
  L3 = _UPVALUE1_
  L3 = L3.decode
  L4 = A0.description
  L2, L3 = L2(L3, L4)
  if L2 and L3 then
    L4 = L3.hardware
    if not L4 then
      goto lbl_42
    end
    L4 = string
    L4 = L4.lower
    L4 = L4(L5)
    if L4 == "r01" then
      goto lbl_42
    end
    L4 = _UPVALUE0_
    L4 = L4.isStrNil
    L4 = L4(L5)
    if not L4 then
      goto lbl_42
    end
  end
  L4 = nil
  do return L4 end
  ::lbl_42::
  L4 = _UPVALUE0_
  L4 = L4.isStrNil
  L4 = L4(L5)
  if not L4 then
    L4 = L3.bssid1
    L1.mac = L4
  end
  L4 = _UPVALUE0_
  L4 = L4.isStrNil
  L4 = L4(L5)
  if not L4 then
    L4 = L3.bssid2
    L1.mac5G = L4
  end
  L4 = L3.hardware
  if L4 then
    L4 = string
    L4 = L4.lower
    L4 = L4(L5)
    if L4 == "r01" then
      L4 = _UPVALUE0_
      L4 = L4.isStrNil
      L4 = L4(L5)
      if L4 then
        L1.needConvert = true
      else
        L4 = _UPVALUE0_
        L4 = L4.macFormat
        L4 = L4(L5)
        L1.mac = L4
      end
    end
  end
  L4 = {}
  if L5 then
    if 0 < L5 then
      for L9, L10 in L6, L7, L8 do
        L12 = L5
        L11 = L5.match
        L13 = "wl"
        L11 = L11(L12, L13)
        if L11 then
          L12 = L5
          L11 = L5.match
          L13 = "wl"
          L11 = L11(L12, L13)
          if not L11 then
            goto lbl_121
          end
          L11 = tonumber
          L12 = A0.assoc
          L11 = L11(L12)
          if L11 ~= 1 then
            goto lbl_121
          end
        end
        L11 = L10.ageing_timer
        if L11 <= 300 then
          L11 = L10.tx_bytes
          if L11 ~= 0 then
            break
          end
          L11 = L10.rx_bytes
          if L11 ~= 0 then
            break
          end
        end
        ::lbl_121::
      end
    end
  end
  if L5 then
    if 0 < L5 then
      for L8, L9 in L5, L6, L7 do
        L10 = L9.is_ap
        if L10 ~= nil then
          L10 = L9.is_ap
          if L10 ~= 0 then
            L10 = _simpleRecursive
            L11 = L9
            L10 = L10(L11)
            if L10 then
              L11 = table
              L11 = L11.insert
              L12 = L4
              L13 = L10
              L11(L12, L13)
            end
          end
        end
      end
      if 0 < L5 then
        L1.leafs = L4
      end
    end
  end
  return L1
end
_simpleRecursive = L4
function L4()
  local L0, L1, L2, L3, L4, L5, L6, L7, L8, L9, L10, L11, L12, L13, L14
  L0 = require
  L1 = "xiaoqiang.util.XQWifiUtil"
  L0 = L0(L1)
  L1 = L0.getWifiBssid
  L1, L2 = L1()
  L3 = {}
  L3.mac = L1
  L4 = L2 or L4
  if not L2 then
    L4 = ""
  end
  L3.mac5G = L4
  L4 = _UPVALUE0_
  L4 = L4.exec
  L5 = "ubus call trafficd hw '{\"tree\":true}'"
  L4 = L4(L5)
  L5 = _UPVALUE1_
  L5 = L5.isStrNil
  L5 = L5(L6)
  if L5 then
    return L3
  else
    L5 = _UPVALUE2_
    L5 = L5.decode
    L5 = L5(L6)
    L4 = L5
  end
  L5 = {}
  for L9, L10 in L6, L7, L8 do
    L11 = L10.is_ap
    if L11 ~= nil then
      L11 = L10.is_ap
      if L11 ~= 0 then
        L11 = _simpleRecursive
        L12 = L10
        L11 = L11(L12)
        if L11 then
          L12 = table
          L12 = L12.insert
          L13 = L5
          L14 = L11
          L12(L13, L14)
        end
      end
    end
  end
  if 0 < L6 then
    L3.leafs = L5
  end
  return L3
end
simpleTopoGraph = L4
