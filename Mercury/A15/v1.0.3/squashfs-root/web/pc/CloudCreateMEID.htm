

<h1 class="cloudTitle">{%label.cloudIDRegist%}</h1>
<div id="tabCon"></div>
<p id="cloudErrTip" class="cloudErrTip commonErrTip"></p>
<div id="inputCon"></div>
<ul id="agree" class="inputCMPT"></ul>
<a class="agreeDoc" href="http://static.mercuryclouds.com.cn/agreement.html" target="_blank">{%label.cloudIDRegistProtocol%}</a>
<li class="wzdSubBtn">
	<div id="create"></div>
	<p class="textBtn"><span id="alreadyHave">{%btn.bindExistingAccount%}</span></p>
</li><script type="text/javascript">(function(){function g(a){var c="";switch(a){case ENONE:return!0;case EINVACCOUNTREGISTED:c=appendErrCode(label.cloudAcccountRegisted,a);break;case EINVACCOUNTNOTEXIST:c=appendErrCode(errStr.invCloudAccountNotExist,a);break;case EINVPASSWORDFMT:case EINVACCOUNTPWDFMT:c=appendErrCode(errStr.pwdInvalid,a);break;case EINVACCOUNTPWDERR:c=appendErrCode(errStr.passwdErr,a);break;case EINVACCOUNTPHONENUMFMT:c=appendErrCode(errStr.invCloudAccountPhoneErr,a);break;case EINVCLOUDUSRCOUNTFORMAT:case EINVACCOUNTEMAILFMT:c=
appendErrCode(errStr.invCloudAccountEmailErr,a);break;case EINVACCOUNTRESETPWDCAPTCHAERR:case EINVVERICODEFORMAT:c=appendErrCode(errStr.CAPTCHAErrorTip,a);break;case EINVCLOUDERRORCAPTCHAINVAL:c=appendErrCode(errStr.invCloudCAPTCHAInval,a);break;default:c=!1==cloudErrHandle(a).result?cloudErrHandle(a).tip:appendErrCode(errStr.invRequestFail,a)}f(c);return!1}function h(a){switch(a){case ENONE:cloudHistory.setState({bind:!0,account:b.getValue()});!0==cloudHistory.isFormWizard?loadingDialog.hide(function(){loadPage("WizardEnd.htm",
"wizardCon")}):cloudPageDialog.hide(function(){refreshNavBarCloudStatus()});return}cloudHistory.setState({bind:!1,createSuccessAndLoginFail:!0,account:b.getValue()});cloudHistory.go(-1);showToast(label.createSuccessAndBind)}function n(a){(function(){0>=a?d.setTips({value:label.cloudIDCaptchaReSend,className:"clickable",onClick:k}):(d.setTips({value:label.cloudIDCaptchaReSend+"("+a--+"s)",className:"unclickable",onClick:function(){}}),$.setTimeout(arguments.callee,1E3))})()}function k(){if(!1!=b.checkAll()){l();
d.setTips({className:"unclickable",value:label.cloudServerWaitingResp,onClick:function(){}});var a=0==m.getCurrentIndex()?p:q;r=$.setTimeout(function(){loadingDialog.show({title:label.createMercuryId,content:{primary:label.waittingResponseFormServer}},void 0,void 0,!0,function(){cloudAccountQueryStop()})},s);cloudAccountGetRegistAC(b.getValue(),a,function(a,b,e){clearTimeout(r);loadingDialog.hide(function(){if(a==cloudResultType.FINISH){if(!0==g(parseInt(e[cloudClientStatus.fileName][cloudClientStatus.secName.getRegVerifyCode][cloudClientStatus.optName.errCode]))){n(t);
return}}else a==cloudResultType.ACTION_ERROR?g(parseInt(b.errCode)):void 0!=b&&!1==b.result&&alarmDialog.show(b.errStr);d.setTips({value:label.cloudIDCaptchaReSend,className:"clickable",onClick:k})})})}}function f(a){a=$("p.cloudErrTip").html('<i class="iconfont icon-error"></i>'+a);a.css("display","table");a.css("margin-left",-(a[0].offsetWidth/2)+"px")}function l(){$("p.cloudErrTip").css("display","none")}function u(){var a=0==m.getCurrentIndex()?p:q;loadingDialog.show({title:label.createMercuryId,
content:{primary:label.creating,secondary:label.creatingTips}},void 0,void 0,!0,cloudAccountQueryStop);cloudAccountRegist(b.getValue(),a,e.getValue(),d.getValue(),function(a,d,f){a==cloudResultType.FINISH?g(parseInt(f[cloudClientStatus.fileName][cloudClientStatus.secName.register][cloudClientStatus.optName.errCode]))?cloudAccountBind(b.getValue(),e.getValue(),function(a,c,b){loadingDialog.hide(function(){a==cloudResultType.FINISH?h(parseInt(b[cloudClientStatus.fileName][cloudClientStatus.secName.bind][cloudClientStatus.optName.errCode])):
a==cloudResultType.CLOSE?h(-1):h(parseInt(c.errCode))})}):loadingDialog.hide():loadingDialog.hide(function(){a==cloudResultType.ACTION_ERROR?g(parseInt(d.errCode)):void 0!=d&&!1==d.result&&alarmDialog.show(d.errStr)})})}var q=uciCloudConfig.optValue.accountTypeEmail,p=uciCloudConfig.optValue.accountTypePhoneNum,t=120,s=2E3,r=null,b=new Input({type:Input.TYPE.PLAIN_TEXT,label:{value:label.cloudIDPhoneNum,position:Input.LABEL.INNER},targetId:"inputCon",check:{blur:function(){if(0==m.getCurrentIndex()){if(0==
this.input.value.length)return this.showNote(label.cloudAccountPhoneMumNull),!1;if(!1==checkPhoneNum(this.input.value))return this.showNote(label.cloudAccountPhoneNumFmtErr),!1}else{if(0==this.input.value.length)return this.showNote(label.cloudAccountEmailNull),!1;if(!1==checkEmail(this.input.value))return this.showNote(label.cloudAccountEmailFmtErr),!1}return!0}},props:{maxlength:"64",type:"text",placeholder:label.cloudIDPlaceHolder}}),d=new Input({type:Input.TYPE.PLAIN_TEXT,label:{value:label.cloudIDRegistCaptcha,
position:Input.LABEL.INNER},tips:{value:label.getVerificationCode,className:"clickable",onClick:k},targetId:"inputCon",check:{blur:function(){return 0==this.input.value.length?(this.showNote(errStr.invVericodeNULL),!1):!0}},props:{maxlength:"6",type:"text"}}),e=new Input({type:Input.TYPE.CIPHER_TEXT,label:{value:label.loginSetPwd,position:Input.LABEL.INNER},strength:{show:!0,least:6,critical:12},targetId:"inputCon",check:{blur:function(){return 0==this.input.value.length?(this.showNote(label.chgPwdnull),
!1):6>this.input.value.length?(this.showNote(label.chgPwdLess),!1):!0},keyup:function(){return""==this.input.value?!0:/\s+/.test(this.input.value)?(this.showNote(errStr.inputPwdCharExistBlank),!1):/^[\x21-\x7e]+$/.test(this.input.value)?!0:(this.showNote(errStr.inputEliegalChar),!1)}},props:{maxlength:"32",type:"password",placeholder:label.cloudPwdPlaceHolder}}),v=new Input({type:Input.TYPE.CIPHER_TEXT,label:{value:label.loginPwdConf,position:Input.LABEL.INNER},targetId:"inputCon",props:{maxlength:"32",
type:"password",placeholder:label.cloudPwdConfPlaceHolder}}),m=new Tab({list:[{name:label.cloudIDRegistPhone,onClick:function(){b.setLabel(label.cloudIDPhoneNum);b.closeNote()}},{name:label.cloudIDRegistMail,onClick:function(){b.setLabel(label.cloudIDMail);b.closeNote()}}],targetId:"tabCon"}),w=new CheckBox({targetId:"agree",label:label.cloudIDRegistReadAndAgree,checked:!0});new Button({text:btn.create,onClick:function(){var a=!0;w.checkbox.checked?(l(),[b,e,d].forEach(function(c){a=c.checkAll()&&
a}),a&&(e.getValue()!=v.getValue()?f(label.chgPwdDif):(l(),u()))):f(errStr.agreeAndReadTip)},type:Button.TYPE.PRIMARY,id:"create"});id("alreadyHave").onclick=function(){cloudHistory.go(-1)};(function(){var a={};a[cloudClientStatus.fileName]={};a[cloudClientStatus.fileName][KEY_NAME]=cloudClientStatus.secName.regVeriCodeTimer;$.query(a,function(a){ENONE==a[ERR_CODE]&&(a=a[cloudClientStatus.fileName][cloudClientStatus.secName.regVeriCodeTimer][cloudClientStatus.optName.regVeriCodeTimer],0<a&&(d.setTips({className:"unclickable",
onClick:function(){}}),n(a)))})})()})();
</script><style type="text/css">h1.cloudTitle{margin-bottom:16px!important}ul.tabCPMT{text-align:center}.clickable{font-size:13px;color:#f36;display:table-cell;white-space:nowrap;padding:0 12px;cursor:pointer}.unclickable{font-size:13px;color:#999;display:table-cell;white-space:nowrap;padding:0 12px;cursor:default}label.checkbox{color:#333}li.wzdSubBtn{margin-top:28px}p.textBtn{margin-top:16px;line-height:20px}p.textBtn span{font-size:13px;color:#ff4d79;cursor:pointer}#inputCon{margin-top:56px}li.wizardBody #cloudErrTip{margin:0 auto;top:102px}div.cloudPageCon #cloudErrTip{margin:0 auto;top:128px}#agree{display:inline-table;vertical-align:middle}a.agreeDoc{display:inline-block;margin-left:100px;height:14px;line-height:14px;vertical-align:middle;font-size:13px;color:#333}</style>