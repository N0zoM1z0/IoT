

<h1 class="cloudTitle">{%label.cloudForgPwd%}</h1>
<p class="cloudTip">{%label.cloudAccountInputAndGetCaptcha%}</p>
<p class="cloudErrTip commonErrTip"></p>
<div id="inputCon"></div>
<li class="wzdSubBtn"><div id="save"></div></li><script type="text/javascript">(function(){function k(b){var a="";switch(b){case ENONE:return!0;case EINVACCOUNTRESETPWDCAPTCHAERR:case EINVVERICODEFORMAT:return d.showNote(errStr.CAPTCHAErrorTip),!1;case EINVACCOUNTNOTEXIST:return c.showNote(errStr.invCloudAccountNotExist),!1;case EINVACCOUNTTYPEERR:return c.showNote(errStr.invCloudAccountType),!1;case EINVACCOUNTPHONENUMFMT:return c.showNote(errStr.invCloudAccountPhoneErr),!1;case EINVCLOUDUSRCOUNTFORMAT:case EINVACCOUNTEMAILFMT:return c.showNote(errStr.invCloudAccountEmailErr),
!1;case EINVDEVICELOCKED:a=appendErrCode(errStr.invCloudDeviceLocked,errNo);break;case EINVCLOUDERRORCAPTCHAINVAL:a=appendErrCode(errStr.invCloudCAPTCHAInval,errNo);break;default:a=!1==cloudErrHandle(b).result?cloudErrHandle(b).tip:appendErrCode(errStr.invRequestFail,b)}e(a);return!1}function l(b){var a="";switch(b){case ENONE:return!0;case EINVERICODEEMPTY:a=errStr.invVericodeNULL;break;case EINVACCOUNTRESETPWDCAPTCHAERR:case EINVVERICODEFORMAT:a=appendErrCode(errStr.CAPTCHAErrorTip,errNo);break;
case EINVACCOUNTNOTEXIST:a=appendErrCode(errStr.invCloudAccountNotExist,errNo);break;case EINVACCOUNTTYPEERR:a=appendErrCode(errStr.invCloudAccountType,errNo);break;case EINVACCOUNTPHONENUMFMT:a=appendErrCode(errStr.invCloudAccountPhoneErr,errNo);break;case EINVCLOUDUSRCOUNTFORMAT:case EINVACCOUNTEMAILFMT:a=appendErrCode(errStr.invCloudAccountEmailErr,errNo);break;case EINVDEVICELOCKED:a=appendErrCode(errStr.invCloudDeviceLocked,errNo);break;case EINVCLOUDERRORCAPTCHAINVAL:a=appendErrCode(errStr.invCloudCAPTCHAInval,
errNo);break;default:cloudErrRel=cloudErrHandle(errNo),a=!1==cloudErrRel.result?cloudErrRel.tip:appendErrCode(errStr.invRequestFail,errNo)}e(a);return!1}function m(b){var a="";switch(b){case ENONE:return cloudHistory.go(-2),showToast(label.resetPwdSuccessAndBind),!0;case EINVACCOUNTRESETPWDCAPTCHAERR:case EINVVERICODEFORMAT:d.showNote(errStr.CAPTCHAErrorTip);return;case EINVACCOUNTNOTEXIST:c.showNote(errStr.invCloudAccountNotExist);return;case EINVMAILFMT:case EINVMAILLEN:case EINVACCOUNTEMAILFMT:c.showNote(errStr.invCloudAccountEmailErr);
return;case EINDEVICEALREADYBOUND:case EINVACCOUNTBINDED:a=errStr.invCloudAccountBindedTips;break;case EINVACCOUNTPHONENUMFMT:a=appendErrCode(errStr.invCloudAccountPhoneErr,b);break;case EINVCLOUDERRORCAPTCHAINVAL:a=appendErrCode(errStr.invCloudCAPTCHAInval,b);break;default:a=!1==cloudErrHandle(b).result?cloudErrHandle(b).tip:appendErrCode(errStr.invRequestFail,b)}e(a);return!1}function e(b){b=$("p.cloudErrTip").html('<i class="iconfont icon-error"></i>'+b);b.css("display","table");b.css("margin-left",
-(b[0].offsetWidth/2)+"px")}function n(){$("p.cloudErrTip").css("display","none")}function p(b){(function(){0>=b?d.setTips({value:label.cloudIDCaptchaReSend,className:"clickable",onClick:g}):(d.setTips({value:label.cloudIDCaptchaReSend+"("+b--+"s)",className:"unclickable",onClick:function(){}}),$.setTimeout(arguments.callee,1E3))})()}function g(){!1!=c.checkAll()&&(n(),d.setTips({className:"unclickable",value:label.cloudServerWaitingResp,onClick:function(){}}),captchaHd=$.setTimeout(function(){loadingDialog.show({title:label.cloudForgPwd,
content:{primary:label.waittingResponseFormServer}},void 0,void 0,!0,function(){cloudAccountQueryStop()})},q),cloudAccountRstPwdAC(c.getValue(),f,function(b,a,c){clearTimeout(captchaHd);loadingDialog.hide(function(){if(b==cloudResultType.FINISH){if(!0==l(parseInt(c[cloudClientStatus.fileName][cloudClientStatus.secName.getResetPwdVerifyCode][cloudClientStatus.optName.errCode]))){p(r);return}}else b==cloudResultType.ACTION_ERROR?l(parseInt(a.errCode)):void 0!=a&&!1==a.result&&alarmDialog.show(a.errStr);
d.setTips({value:label.cloudIDCaptchaReSend,className:"clickable",onClick:g})})}))}function s(){loadingDialog.show({title:label.cloudForgPwd,content:{primary:label.resettinfPwd}},void 0,void 0,!0,cloudAccountQueryStop);cloudAccountRstPwdCheckCAPTCHA(c.getValue(),d.getValue(),function(b,a,e){b==cloudResultType.FINISH?!0==k(parseInt(e[cloudClientStatus.fileName][cloudClientStatus.secName.checkResetPwdVerifyCode][cloudClientStatus.optName.errCode]))?cloudAccountRstPwd(c.getValue(),h.getValue(),d.getValue(),
f,function(a,b,c){a==cloudResultType.FINISH?loadingDialog.hide(function(){m(parseInt(c[cloudClientStatus.fileName][cloudClientStatus.secName.resetPassword][cloudClientStatus.optName.errCode]))}):loadingDialog.hide(function(){void 0!=b&&!1==b.result&&m(parseInt(b.errCode))})}):loadingDialog.hide():loadingDialog.hide(function(){b==cloudResultType.ACTION_ERROR?k(parseInt(a.errCode)):void 0!=a&&!1==a.result&&alarmDialog.show(a.errStr)})})}var r=120,q=2E3,f,c=new Input({type:Input.TYPE.PLAIN_TEXT,label:{value:label.cloudMEID,
position:Input.LABEL.INNER},targetId:"inputCon",check:{blur:function(){if(0==this.input.value.length)return this.showNote(label.cloudAccountNull),!1;if(!0==checkNum(this.input.value)){if(!1==checkPhoneNum(this.input.value))return this.showNote(errStr.invCloudAccountFmtErr),!1;f=uciCloudConfig.optValue.accountTypePhoneNum;return!0}if(!1==checkEmail(this.input.value))return this.showNote(errStr.invCloudAccountFmtErr),!1;f=uciCloudConfig.optValue.accountTypeEmail;return!0}},props:{maxlength:"64",type:"text",
placeholder:label.cloudIDPlaceHolder}}),d=new Input({type:Input.TYPE.PLAIN_TEXT,label:{value:label.cloudIDRegistCaptcha,position:Input.LABEL.INNER},tips:{value:label.getVerificationCode,className:"clickable",onClick:g},targetId:"inputCon",check:{blur:function(){return 0==this.input.value.length?(this.showNote(errStr.invVericodeNULL),!1):!0}},props:{maxlength:"6",type:"text"}}),h=new Input({type:Input.TYPE.CIPHER_TEXT,label:{value:label.cloudForgPwdSetNewPwd,position:Input.LABEL.INNER},strength:{show:!0,
least:6,critical:12},targetId:"inputCon",check:{blur:function(){return 0==this.input.value.length?(this.showNote(label.chgPwdnull),!1):6>this.input.value.length?(this.showNote(label.chgPwdLess),!1):!0},keyup:function(){return""==this.input.value?!0:/\s+/.test(this.input.value)?(this.showNote(errStr.inputPwdCharExistBlank),!1):/^[\x21-\x7e]+$/.test(this.input.value)?!0:(this.showNote(errStr.inputEliegalChar),!1)}},props:{maxlength:"32",type:"password",placeholder:label.cloudPwdPlaceHolder}}),t=new Input({type:Input.TYPE.CIPHER_TEXT,
label:{value:label.cloudForgPwdConfNewPwd,position:Input.LABEL.INNER},targetId:"inputCon",props:{maxlength:"32",type:"password",placeholder:label.cloudPwdConfPlaceHolder}});new Button({text:btn.save,onClick:function(){var b=!0;[c,h,d].forEach(function(a){b=a.checkAll()&&b});b&&(h.getValue()!=t.getValue()?e(label.chgPwdDif):(n(),s()))},type:Button.TYPE.PRIMARY,id:"save"});(function(){var b={};b[cloudClientStatus.fileName]={};b[cloudClientStatus.fileName][KEY_NAME]=cloudClientStatus.secName.regVeriCodeTimer;
$.query(b,function(a){ENONE==a[ERR_CODE]&&(a=a[cloudClientStatus.fileName][cloudClientStatus.secName.regVeriCodeTimer][cloudClientStatus.optName.regVeriCodeTimer],0<a&&(d.setTips({className:"unclickable",onClick:function(){}}),p(a)))})})()})();
</script><style type="text/css">li.wzdSubBtn{margin-top:24px}li.inputLi label{width:104px}.unclickable{font-size:13px;color:#999;display:table-cell;white-space:nowrap;padding:0 12px;cursor:default}</style>