
<ul class="wzdUl">
	<li class="wizardSkip"></li>
	<li class="wizardBody">
		<i id="completeImg" class="completeImg"></i>
		<p id="lanIpAddr" class="lanIp">LAN口 IP: <span id="lanIpAddrVal" class="lanIp"></span></p>
		<p id="conclusion"></p>
		<div class="dfsTipsCon" id="dfsTips">
			<p class="dfsP">遵照国家法律法规，路由器正在做退避雷达信号探测，</p>
			<p class="dfsCountdownP">Wi-Fi信号要 <span id="wizardDFScountdown"></span><span class="dfsSecond">秒</span> 后才能上线，请稍候...</p>
		</div>
		<p id="bindStatus"></p>
		<ul class="wifiList" id="wifiList"></ul>
		<div id="finish"></div>
	</li>
</ul>

<script type="text/javascript">function init(){function h(b){$("#wizardDFScountdown").html(f);k=setInterval(function(){f--;$("#wizardDFScountdown").html(f);0>=f&&(clearInterval(k),"undefined"!=typeof b&&b())},1E3)}function l(b){function a(a,c){e.push({title:c,name:a,ssid:b[a][uciWireless.dynOptName.ssid],key:b[a][uciWireless.dynOptName.key]})}var e=[],c=gWizardData.isBandSteeringOpen;switch(slp.bandsProvided){case slp.SINGLE:a(uciWireless.dynData.host_2g,label.wirelessHost);break;case slp.DOUBLE:!0==c?a(uciWireless.secName.wlanBS,
label.wirelessHost):(a(uciWireless.dynData.host_2g,label.wirelessNet2G),a(uciWireless.dynData.host_5g,label.wirelessNet5G));break;case slp.TRIPLE:!0==c?a(uciWireless.secName.wlanBS,label.wirelessHost):(a(uciWireless.dynData.host_2g,label.wirelessNet2G),a(uciWireless.dynData.host_5g1,label.wirelessNet5G1),a(uciWireless.dynData.host_5g2,label.wirelessNet5G2))}return e}function g(){$.setTimeout(function(){lanDetecting(function(){loadPage("Basic.htm","Con")})},n)}var f=0,k=null,n=4E3;(function(){var b=
id("wifiList");l(gWizardData.wifiConf).forEach(function(a){void 0!=gWizardData.gWifiCfgSave[a.name]&&(void 0!=gWizardData.gWifiCfgSave[a.name].ssid&&(gWizardData.wifiConf[a.name].ssid=gWizardData.gWifiCfgSave[a.name].ssid),void 0!=gWizardData.gWifiCfgSave[a.name].key&&(gWizardData.wifiConf[a.name].key=gWizardData.gWifiCfgSave[a.name].key))});l(gWizardData.wifiConf).forEach(function(a){var e,c,d;e=document.createElement("li");b.appendChild(e);c=document.createElement("h2");c.innerHTML=a.title;e.appendChild(c);
c=document.createElement("p");e.appendChild(c);d=document.createElement("i");d.className="iconfont icon-wifi";c.appendChild(d);d=document.createElement("span");d.innerHTML=htmlEscape(a.ssid);d.title=a.ssid;c.appendChild(d);c=document.createElement("p");e.appendChild(c);d=document.createElement("i");d.className="iconfont icon-password";c.appendChild(d);d=document.createElement("span");d.innerHTML=htmlEscape(0==a.key.length?label.noHasPwd:a.key);d.title=0==a.key.length?label.noHasPwd:a.key;c.appendChild(d)})})();
var m={};slp.gSysModeSupport&&gSysMode==uciSystem.optValue.sysMode.wdsMode?($("#lanIpAddrVal").html(gLanIP),$(".lanIp").show(),id("conclusion").innerHTML=label.wizardDoneAndRememberWiFi,id("finish").style.display="inline-block",gWizardData.bShowDFS&&(f=gWizardData.countdown,h(function(){$("#dfsTips").hide()}),$("#dfsTips").show()),null!=cloudHistory&&(id("bindStatus").style.display="block",cloudHistory.state.bind?id("bindStatus").innerHTML=label.bindedCloudId+label.colon+htmlEscape(cloudHistory.state.account):
id("bindStatus").innerHTML=label.noBindCloudId),new Button({text:btn.confirmTip,onClick:function(){var b={};b.network={lan:{ipaddr:gLanIP,ip_mode:"dynamic",netmask:gLanMask}};b.dhcpd={udhcpd:{enable:"0",auto:"1"}};b[uciWireless.fileName]=gWizardData.gWifiCfgSave;loadingDialog.show({content:{primary:"正在保存设置，请稍候..."}});$.modify(b,function(a){gSysMode==uciSystem.optValue.sysMode.apMode?$.action({wired_extender:{set_ip:null}}):gSysMode==uciSystem.optValue.sysMode.wdsMode&&$.action({network:{apply_lan_config:null},
wireless:{wds_finish:null}},null,!0);gIsLanIpChanged?($.setTimeout(function(){window.location.href="http://"+gLanIP},6E4),$.changeDomain(gLanIP),$.setTimeout(function(){lanDetecting(function(){window.location.href="http://"+gLanIP})},4E3)):g()})},type:Button.TYPE.PRIMARY,id:"finish"})):slp.gSysModeSupport&&gSysMode==uciSystem.optValue.sysMode.apMode?($("#lanIpAddrVal").html(gLanIP),$(".lanIp").show(),id("finish").style.display="inline-block",new Button({text:btn.confirmTip,onClick:function(){var b=
{};b[uciWireless.fileName]=gWizardData.gWifiCfgSave;loadingDialog.show({content:{primary:"正在保存设置，请稍候..."}});$.modify(b,function(a){$.action({wired_extender:{set_ip:null}});$.setTimeout(function(){window.location.href="http://"+gLanIP},6E4);$.changeDomain(gLanIP);$.setTimeout(function(){lanDetecting(function(){window.location.href="http://"+gLanIP})},4E3)})},type:Button.TYPE.PRIMARY,id:"finish"})):gWizardData.wifiDisconnect&&gWizardData.wifiChanged?($("#conclusion").html("NO"==gBeInCNA?label.wizardDoneAndReconnectWiFi:
label.wizardDoneAndClickDone),wzdDone(),m[uciWireless.fileName]=gWizardData.gWifiCfgSave,$.modify(m,function(b){b[ERR_CODE]!=ENONE?(loadingDialog.hide(function(){alarmDialog.show(errStr.unknown+b[ERR_CODE])}),"NO"==gBeInCNA&&g()):b.dfs_wait_time&&0!=b.dfs_wait_time?(f=b.dfs_wait_time,h(function(){$("#dfsTips").hide();"NO"==gBeInCNA&&g()}),$("#dfsTips").show()):"NO"==gBeInCNA&&g()})):(id("conclusion").innerHTML=label.wizardDoneAndRememberWiFi,id("finish").style.display="inline-block",gWizardData.bShowDFS&&
(f=gWizardData.countdown,h(function(){$("#dfsTips").hide()}),$("#dfsTips").show()),null!=cloudHistory&&(id("bindStatus").style.display="block",cloudHistory.state.bind?id("bindStatus").innerHTML=label.bindedCloudId+label.colon+htmlEscape(cloudHistory.state.account):id("bindStatus").innerHTML=label.noBindCloudId),"NO"==gBeInCNA?slp.gSysModeSupport&&gSysMode!=uciSystem.optValue.sysMode.routerMode||new Button({text:btn.confirmTip,onClick:function(){loadPage("Basic.htm","Con")},type:Button.TYPE.PRIMARY,
id:"finish"}):$("#conclusion").html(label.wizardDoneAndClickDone))}init();
</script><style type="text/css">i.completeImg{display:inline-block;width:160px;height:160px;background:url(../web-static/images/wizardEndDut.png) no-repeat}li.wizardBody{text-align:center}#conclusion{font-size:24px;font-weight:bold;color:#333;line-height:36px;margin-top:16px}#bindStatus{display:none;font-size:13px;color:#666;line-height:20px;margin-top:8px}ul.wifiList{margin:24px 0}ul.wifiList li{width:206px;height:106px;border:1px solid #e0e0e0;border-radius:4px;display:inline-block;padding:24px;text-align:left}ul.wifiList li+li{margin-left:16px}ul.wifiList h2{font-size:24px;font-weight:bold;color:#666;line-height:36px;margin-bottom:14px}ul.wifiList p{margin-bottom:8px}ul.wifiList i{font-size:24px;color:#969799;vertical-align:middle}ul.wifiList span{font-size:14px;color:#333;vertical-align:middle;margin-left:9px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;display:inline-block;width:173px}#finish{display:none;width:280px}div.dfsTipsCon{display:none;font-size:13px}div.dfsTipsCon p.dfsP{margin-top:8px;line-height:20px}div.dfsTipsCon p.dfsCountdownP{line-height:32px}div.dfsTipsCon #wizardDFScountdown{font-size:24px;font-weight:bold;color:#f36}div.dfsTipsCon p.dfsCountdownP span.dfsSecond{color:#f36}.lanIp{display:none;font-size:13px;color:#666}</style>