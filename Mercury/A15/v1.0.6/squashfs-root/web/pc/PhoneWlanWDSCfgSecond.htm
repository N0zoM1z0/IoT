

<h1 class="phoneTitle">桥接（无线中继）</h1>
<p class="routerPwdInfo"></p>
<p class="WDSTitle routerPwdInfo">
	请输入前端路由的Wi-Fi密码
</p>
<div id="wdsInputDiv" class="WDSFoBlock"></div>

<div class="phFunc">
    <label id="pre" class="phTwoBtnL">上一步</label>
    <label id="next" class="phTwoBtnR">下一步</label>
</div><script type="text/javascript">(function(){function h(d,a){var c="wifiPwd"+a,b="wifiPwdNote"+a;switch(d){case ENONE:return!1;case EWLANPWDBLANK:showPhoneNote(c,b,errStr.wlanPwdNull);break;case EINVWLANPWD:showPhoneNote(c,b,errStr.wlanPwdInvalid);break;case EINVPSKLEN:showPhoneNote(c,b,errStr.wlanPwdLenValid);break;default:showPhWzdAlert(errStr.invRequestFail)}return!0}function k(d){closePhoneNote("wifiPwd"+d,"wifiPwdNote"+d)}function l(d,a,c){var b,m=document.createElement("ul"),m='<ul class="phInputUl"><li class="phInputLi ssidName"><label>'+
("BS"==a?label.wirelessName:gFreqInfo[a]+"频段")+'</label><i class="clapboard"></i><input value="'+d.ssid+'" disabled="true" /></li><li id="'+("wifiPwdLi"+a)+'" class="phInputLi"><label for="'+("wifiPwd"+a)+'">'+label.wirelessPwd+'</label><i class="clapboard"></i><input id="'+("wifiPwd"+a)+'" value="'+d.key+'" type="password" maxlength="63" /><i id="togglePwdShow'+a+'" class="pwdShowOff" /></li><li id="wifiPwdNote'+a+'" class="phErrTip disNone"><span class="errDes"></span></li></ul>';b="#togglePwdShow"+
a;$("#wdsInputDiv").append(m);$(b).click(function(){$(b).toggleClass("pwdShowOff pwdShowOn");id("wifiPwd"+a).type="pwdShowOff"==$(b).attr("class")?"password":"text"});c||(id("wifiPwdLi"+a).className="phInputLi ssidName",id("wifiPwd"+a).value="未加密",id("wifiPwd"+a).disabled=!0,id("wifiPwd"+a).type="text",id("togglePwdShow"+a).style.display="none")}function n(){var b={wireless:{}},b=BAND_2==slp.bandsProvided-1?{wireless:{wlan_wds_2g:{enable:"0",ssid:""},wlan_wds_5g:{enable:"0",ssid:""}}}:{wireless:{wlan_wds_2g:{enable:"0",
ssid:""},wlan_wds_5g_1:{enable:"0",ssid:""},wlan_wds_5g_4:{enable:"0",ssid:""}}},a;for(a in wdsTargetSelFreq)if(wdsTargetSelFreq[a].selected){var c={enable:"1"};c.ssid=gRootAPInfo[a].ssid;c.encryption=gRootAPInfo[a].encryption;"0"!=c.encryption&&(c.key=wdsTargetSelFreq[a].bs?id("wifiPwdBS").value:id("wifiPwd"+a).value,gRootAPInfo[a].key=c.key);b.wireless[gWDSModel[a].set_wds]=c;gRootAPInfo[a].enable="1"}return b}function e(){if(!f){var b,a;for(a in wdsTargetSelFreq)if(wdsTargetSelFreq[a].selected&&
gRootAPInfo[a].encryption==uciWireless.dynOptValue.encryption.on){if(wdsTargetSelFreq[a].bs){b=id("wifiPwdBS").value;b=checkWlanPwd(b);if(ENONE!=b)return h(b,"BS");k("BS");break}b=id("wifiPwd"+a).value;b=checkWlanPwd(b);if(ENONE!=b)return h(b,a);k(a)}}a=n();$.modify(a,function(a){a=a[ERR_CODE];if(ENONE==a){var b=null;a={wireless:{}};for(var d in wdsTargetSelFreq)wdsTargetSelFreq[d].selected&&(a.wireless[gWDSModel[d].wds_start]={set_ip_immediate:"0"});$.action(a);showPhLoading("正在配置");if(!0==bWirelessLinked){var e=
!1,f=1,g=function(){if(3<f&&!1==e){var a="";"1"==gLocalAPInfo[curEqtFreq].encryption&&(a="  无线密码："+gLocalAPInfo[curEqtFreq].key);a="您的设备与路由器的连接已断开，请重新进行无线连接...<br />"+("无线名称："+gLocalAPInfo[curEqtFreq].ssid+a);e=!0;closePhLoading();showPhWzdAlert(a)}$.detect(function(){!1==$.result.timeout&&(clearTimeout(b),closePhLoading(),showPhLoading("正在中继"),connectingCount=1,getWdsStatusHd=$.setTimeout(wdsStatusHd,100))});f++;b=$.setTimeout(g,2E3)};clearTimeout(b);b=$.setTimeout(g,4E3)}else connectingCount=1,
$.setTimeout(wdsStatusHd,5E3)}else closePhLoading(),errHandle(a),$(".textCenter").hide(),$(".WDSTitle").show(),$("#wdsInputDiv").show(),$(".phFunc").show()})}var f=!0,b;for(b in wdsTargetSelFreq)if(wdsTargetSelFreq[b].selected){var g=gRootAPInfo[b].encryption==uciWireless.dynOptValue.encryption.on;g&&(f=!1);if(wdsTargetSelFreq[b].bs){l(gRootAPInfo[b],"BS",g);break}else l(gRootAPInfo[b],b,g)}f&&(backFromNextPage?(backFromNextPage=!1,loadPage("PhoneWlanWDSCfgFirst.htm","phCon")):e());for(b=0;b<gWDSPwdErrList.length;b++)wdsTargetSelFreq[gWDSPwdErrList[b]].bs?
showPhoneNote("wifiPwdBS","wifiPwdNoteBS","请输入正确的无线密码"):showPhoneNote("wifiPwd"+gWDSPwdErrList[b],"wifiPwdNote"+gWDSPwdErrList[b],"请输入正确的无线密码");gWDSPwdErrList=[];failRetry&&(failRetry=!1,e());$("#next").click(function(){e()});$("#pre").click(function(){loadPage("PhoneWlanWDSCfgFirst.htm","phCon")})})();
</script><style type="text/css">img.configGif{height:30px;margin:120px auto 40px;width:30px}p.configTip{color:#fff;font-size:15px;text-align:center}.textCenter{text-align:center;display:none}div.WDSFoBlock{color:#fff;margin-top:13px;position:relative;text-align:left}p.WDSFoNoteF{margin-top:25px;line-height:25px}li.ssidName{margin-bottom:16px}li.ssidName label{color:#666}li.ssidName i.clapboard{border-right:1px solid #ccc}li.ssidName input{color:#333}li.phInputLi input{box-sizing:border-box}li.phErrTip span.errDes{line-height:16px}p.routerPwdInfo{font-size:13px;color:#666;text-align:center}</style>