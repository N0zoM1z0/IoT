

<div class="head">
	<div class="title">
		<h1>{%menuStr.wirelessSwitch%}</h1>
		<i class="helpBtn iconfont icon-help" helpStr="wlanSwitchHelp"></i>
		<div id="switchCon" class="switchCon switchConHs">
			<i class="switchBg"></i>
			<i class="switchBall"/></i>
		</div>
	</div>
	<p class="description">{%titleDescriptionStr.wirelessSwitchDescription%}</p>
</div>
<div id="wirelessSwitchTable"></div><script type="text/javascript">(function(){function r(a){var b="";switch(a){case ENONE:return!0;case ETSTIMECONFLICT:b=errStr.switchTimeConflict;break;case ETSTIMEPERIODTOOLONG:b=errStr.timePeriodTooLong;break;default:b=errStr.unknown+a}alarmDialog.show(b);return!1}function F(){var a={};a[g]={};a[g][k]=G;null!=s&&(clearTimeout(s),s=null);!0!=B&&($.query(a,function(a){B=parseInt(a[g][G][t]);null!=C&&(H==C.state&&!1==B?addTitleError("cntNtpFail",label.cntNtpFailForWlanSwitch):removeTitleError("cntNtpFail"))}),s=$.setTimeout(F,1E3))}
function I(a,b){J.setDataSource(a);J.loadData();"function"==typeof b&&b()}function K(){var a="";l=[];for(var b=0;b<d.length;b++)a="",l[b]={},l[b][k]=d[b][k],l[b][SEC_NAME]=d[b][SEC_NAME],d[b][p]>d[b][q]&&(a=label.lBrackets+label.timePeriodNextDay+label.rBrackets),l[b].timeDesc=d[b][p]+label.timePeriodClose+"/"+a+d[b][q]+label.timePeriodOpen,l[b].weekDesc=("0"==d[b][u]?"":m.mon)+("0"==d[b][v]?"":m.tue)+("0"==d[b][w]?"":m.wed)+("0"==d[b][x]?"":m.thu)+("0"==d[b][y]?"":m.fri)+("0"==d[b][z]?"":m.sat)+
("0"==d[b][A]?"":m.sun)}function M(a){var b={},c={};b[g]={};b[g][D]=c;c[t]=a;$.modify(b,function(a){r(a[ERR_CODE])})}function L(a,b){var c={},e,f,n;void 0==a?(e=calcNextIndex(d),c.mode="add",c.index=e,c.name=label.timeSection+e,c.startHour=c.startMin=c.endHour=c.endMin="00",c.mon=c.tue=c.wed=c.thu=c.fri=c.sat=c.sun=!0):(e=a[SEC_NAME].replace(/.*_(\d)$/,"$1"),f=a[p].split(":"),n=a[q].split(":"),c.mode="edit",c.index=e,c.arrayIndex=b,c.itemName=a[SEC_NAME],c.name=a.name,c.startHour=f[0],c.startMin=
f[1],c.endHour=n[0],c.endMin=n[1],c.mon="0"==a[u]?!1:!0,c.tue="0"==a[v]?!1:!0,c.wed="0"==a[w]?!1:!0,c.thu="0"==a[x]?!1:!0,c.fri="0"==a[y]?!1:!0,c.sat="0"==a[z]?!1:!0,c.sun="0"==a[A]?!1:!0);return c}function E(a){var b={};b[h]={};b[h][KEY_TABLE]=h;$.query(b,function(b){d=formatTableData(b[g][h]);K();I(l,a)})}function N(a){C=new Switch("switchCon",a[g][D][t],M,!1);F();d=formatTableData(a[g][h]);K();I(l)}var d=[],l=[],g=uciTimeSwitch.fileName,h=uciTimeSwitch.secType.timeSwitch,D=uciTimeSwitch.secName.general,
G=uciTimeSwitch.secName.clockSuccess,k=uciTimeSwitch.optName.name,u=uciTimeSwitch.optName.mon,v=uciTimeSwitch.optName.tue,w=uciTimeSwitch.optName.wed,x=uciTimeSwitch.optName.thu,y=uciTimeSwitch.optName.fri,z=uciTimeSwitch.optName.sat,A=uciTimeSwitch.optName.sun,t=uciTimeSwitch.optName.enable,p=uciTimeSwitch.optName.startTime,q=uciTimeSwitch.optName.endTime,H=uciTimeSwitch.optValue.enable.on,C=null,B=!1,s=null,m={mon:label.one,tue:label.two,wed:label.three,thu:label.four,fri:label.five,sat:label.six,
sun:label.day},J=new Table({title:label.settingWifiDisable,targetId:"wirelessSwitchTable",head:[{field:label.periodDesc,width:"0.34"},{field:label.switchTime,width:"0.40"},{field:label.repeatWeek,width:"0.26"}],column:[{name:k,type:"str"},{name:"timeDesc",type:"str"},{name:"weekDesc",type:"str"}],hasCheckBox:!0,editable:!1,addable:!1,max:WLAN_SWITCH_RULE_MAX,itemOption:[{icon:"icon-edit",type:"edit",str:btn.edit,func:function(a,b){var c=L(d[a],a);timePeriodDialog.show(c)}}],tableOption:[{icon:"icon-add",
type:"add",str:btn.add,func:function(){var a=L();timePeriodDialog.show(a)},selRelate:!1}],clickList:{click_del_item:{func:function(a,b){var c={},e={},f=[];c[g]=e;e[k]=f;var e=a.split("-"),n;for(n in e)e.hasOwnProperty(n)&&(f[f.length]=d[e[n]][SEC_NAME]);$.del(c,function(a){r(a[ERR_CODE])&&(showToast(label.deleteSuccess),E())})},asyn:!0}}});timePeriodDialog.resetTpType(timePeriodDialog.tpType.TIME_SWITCH);timePeriodDialog.resetCommit(function(a){for(var b=0;b<d.length;b++)if((!1==a.mon?"0":"1")==d[b][u]&&
(!1==a.tue?"0":"1")==d[b][v]&&(!1==a.wed?"0":"1")==d[b][w]&&(!1==a.thu?"0":"1")==d[b][x]&&(!1==a.fri?"0":"1")==d[b][y]&&(!1==a.sat?"0":"1")==d[b][z]&&(!1==a.sun?"0":"1")==d[b][A]&&a.startHour+":"+a.startMin==d[b][p]&&a.endHour+":"+a.endMin==d[b][q]&&(!a.arrayIndex||a.arrayIndex!=b)){showToast(label.sameRule);return}var b=[u,v,w,x,y,z,A],c={},e={},f={};c[g]=e;"add"==a.mode?(e[KEY_TABLE]=h,e[k]=e[KEY_TABLE]+"_"+a.index,e[KEY_PARA]=f):e[a.itemName]=f;for(e=0;e<b.length;e++)f[b[e]]=!0==a[b[e]]?"1":"0";
f[p]=a.startHour+":"+a.startMin;f[q]=a.endHour+":"+a.endMin;f[k]=a[k];f[t]=H;"add"==a.mode?$.add(c,function(a){r(a[ERR_CODE])&&timePeriodDialog.hide(function(){showToast(label.addSuccess);E()})}):$.modify(c,function(a){r(a[ERR_CODE])&&timePeriodDialog.hide(function(){showToast(label.saveSuccess);E()})})});(function(){var a={};a[h]={};a[h][KEY_TABLE]=h;a[h][k]=D;$.query(a,N)})()})();
</script><style type="text/css"></style>