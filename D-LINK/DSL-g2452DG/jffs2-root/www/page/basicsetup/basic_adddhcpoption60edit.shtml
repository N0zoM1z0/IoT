<html>
<head>
<meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>
<link rel="stylesheet" rev="stylesheet" href="/css/content.css" type="text/css">
<script language="javascript" src="/js/check.js"></script>
<script language="javascript" src="/js/config.js"></script>
<script language="javascript" src="/js/tri.js"></script>
<script language="javascript" src="/js/jquery.js"></script>
<script language="javascript" src="/js/init.js"></script>
<script language="javascript" src="/js/project.js"></script>
<script language="javascript" src="/js/t_utils.js"></script>
</head>
<script>
function ConnectionTuple(){
    this.path="";
    this.Enable="";
    this.PoolOrder="";
    this.DeviceClassName="";
    this.VendorClassID="";
    this.VendorClassIDExclude="";
    this.VendorClassIDMode="";
    this.MinAddress="";
    this.MaxAddress="";
    this.SubnetMask="";
    this.DNSServers="";
    this.IPRouters="";
    this.DHCPLeaseTime="";
}
var index = 0;
var G_DhcpOption60Tab = new Array();
<!--#getobject "InternetGatewayDevice.LANDevice.1.LANHostConfigManagement.DHCPConditionalServingPool. Enable PoolOrder DeviceClassName VendorClassID VendorClassIDExclude VendorClassIDMode MinAddress MaxAddress SubnetMask DNSServers IPRouters DHCPLeaseTime" -->
G_DhcpOption60Tab[index] = new ConnectionTuple();
G_DhcpOption60Tab[index].path = "<!--#path -->";
G_DhcpOption60Tab[index].Enable = "<!--#leaf "1"-->";
G_DhcpOption60Tab[index].PoolOrder = "<!--#leaf "2"-->";
G_DhcpOption60Tab[index].DeviceClassName = "<!--#leaf "3"-->";
G_DhcpOption60Tab[index].VendorClassID = "<!--#leaf "4"-->";
G_DhcpOption60Tab[index].VendorClassIDExclude = "<!--#leaf "5"-->";
G_DhcpOption60Tab[index].VendorClassIDMode = "<!--#leaf "6"-->";
G_DhcpOption60Tab[index].MinAddress = "<!--#leaf "7"-->";
G_DhcpOption60Tab[index].MaxAddress = "<!--#leaf "8"-->";
G_DhcpOption60Tab[index].SubnetMask = "<!--#leaf "9"-->";
G_DhcpOption60Tab[index].DNSServers = "<!--#leaf "10"-->";
G_DhcpOption60Tab[index].IPRouters = "<!--#leaf "11"-->";
G_DhcpOption60Tab[index].DHCPLeaseTime = "<!--#leaf "12"-->";
index++;
<!--#endgetobject -->
<!--#getobject "InternetGatewayDevice.LANDevice.1.LANHostConfigManagement. MinAddress MaxAddress" -->
    var G_MinAddress = "<!--#leaf "1"-->";
    var G_MaxAddress = "<!--#leaf "2"-->";
<!--#endgetobject -->

function checkValue()
{
	var deviceClassName = $('DeviceClassName');
	var vendorClassID = $('VendorClassID');
	var minAddress = $('MinAddress');
	var maxAddress = $('MaxAddress');
	var dNSServer1 = $('DNSServer1');
	var dNSServer2 = $('DNSServer2');
	var subnetMask = $('SubnetMask');
	var iPRouters = $('IPRouters');
	var dHCPLeaseTime = $('DHCPLeaseTime');

	if(deviceClassName.value == "") {
		top.AlertMsg("Device Class Name can not be null","DeviceClassName");
		return false;
	}
	if(vendorClassID.value == "") {
		top.AlertMsg("Vendor Class ID can not be null","VendorClassID");
		return false;
	}
/*	if(!isCheckIPV4($('minAddress'),1,254)){
		top.AlertMsg("Min Address is out of valid range","MinAddress");
		return false
	}
	if(!isCheckIPV4($('maxAddress'),1,254)){
		top.AlertMsg("Max Address is out of valid range","MaxAddress");
		return false
	}
	if(!isCheckIPV4($('dNSServer1'),1,254)){
		top.AlertMsg("DNS Server1 is out of valid range","DNSServer1");
		return false
	}
	if(!isCheckIPV4($('DNSServer2'),1,254)){
		top.AlertMsg("DNS Server2 is out of valid range","DNSServer2");
		return false
	}
	if(!isCheckIPV4($('subnetMask'),1,254)){
		top.AlertMsg("SubnetMask is out of valid range","SubnetMask");
		return false
	}
	if(!isCheckIPV4($('iPRouters'),1,254)){
		top.AlertMsg("IP Routers is out of valid range","IPRouters");
		return false
	}*/
	return true
}

var op = "";
var value = "";

function uiAdd()
{
	var object_path = "InternetGatewayDevice.LANDevice.1.LANHostConfigManagement.DHCPConditionalServingPool."
	var df = document.dataform
	AddElements(df, "add_obj", object_path)
	AddElements(df, object_path + '{i}.Enable', $('Enable').checked == true ? 1: 0)
	AddElements(df, object_path + '{i}.DeviceClassName', getValue("DeviceClassName"))
	AddElements(df, object_path + '{i}.VendorClassID', getValue("VendorClassID"))
	AddElements(df, object_path + '{i}.VendorClassIDMode', getValue("SELECT_VendorClassIDMode"))
	AddElements(df, object_path + '{i}.MinAddress', getValue("MinAddress"))
	AddElements(df, object_path + '{i}.MaxAddress', getValue("MaxAddress"))
	AddElements(df, object_path + '{i}.DNSServers', getValue("DNSServer1") + "," + getValue("DNSServer2"))
	AddElements(df, object_path + '{i}.SubnetMask', getValue("SubnetMask"))
	AddElements(df, object_path + '{i}.IPRouters', getValue("IPRouters"))
	AddElements(df, object_path + '{i}.DHCPLeaseTime', getValue("DHCPLeaseTime"))
	df.submit()
}

function uiEdit()
{
	var df = document.dataform
	AddElements(df, value[0] + 'Enable', $('Enable').checked == true ? 1: 0)
	AddElements(df, value[0] + 'DeviceClassName', getValue("DeviceClassName"))
	AddElements(df, value[0] + 'VendorClassID', getValue("VendorClassID"))
	AddElements(df, value[0] + 'VendorClassIDMode', getValue("SELECT_VendorClassIDMode"))
	AddElements(df, value[0] + 'MinAddress', getValue("MinAddress"))
	AddElements(df, value[0] + 'MaxAddress', getValue("MaxAddress"))
	AddElements(df, value[0] + 'DNSServers', getValue("DNSServer1") + "," + getValue("DNSServer2"))
	AddElements(df, value[0] + 'SubnetMask', getValue("SubnetMask"))
	AddElements(df, value[0] + 'IPRouters', getValue("IPRouters"))
	AddElements(df, value[0] + 'DHCPLeaseTime', getValue("DHCPLeaseTime"))
	df.submit()
}

function uiSubmit()
{
	if(!checkValue())
		return
	if(!validateCode())
		return
	if(op == "add")
		uiAdd()
	else if(op == "edit")
		uiEdit()
}

function uiBack()
{
	document.location.href = "basic_adddhcpoption60.shtml"
}

function __init()
{
	var url = window.location.search
	var i = url.indexOf("?")
	if (i == -1) {
        return
	}
	var arr = url.toString()
	var strs = arr.split("&")
	op = strs[0].split("=")[1]

	if(op == "edit") {
		var valueArr = strs[1].split("=")[1]
		value = valueArr.split(",")
		setValue("Enable",value[1])
		setValue("DeviceClassName",value[2])
		setValue("VendorClassID",value[3])
		setValue("MinAddress",value[4])
		setValue("MaxAddress",value[5])
		setValue("DNSServer1",value[6])
		setValue("DNSServer2",value[7])
		setValue("SubnetMask",value[8])
		setValue("IPRouters",value[9])
		setValue("DHCPLeaseTime",value[10])
	}
    if(IsExistedFunction("project_init") == true) 
        project_init(GetCurrentFileName());
}
</script>
<body>
<script>printBeginContent();</script>
<script>SetContentTitle(getStr("LK_DhcpOption60Edit"));</script>
<form method="get">
	<table class="ContentTableNoColor" cellspacing="0" cellpadding="0">
		<tr>
			<td width="150" langkey="LK_DhcpOption60_Enable"></td>
			<td><input type='checkbox' id='Enable' checked></td>
		</tr>
		<tr>
			<td width="150" langkey="LK_DhcpOption60_DeviceClassName"></td>
			<td><input type="text" id="DeviceClassName" maxlength="128">
		</tr>
		<tr>
			<td width="150" langkey="LK_DhcpOption60_VendorClassID"></td>
			<td><input type="text" id="VendorClassID" maxlength="128">
		</tr>
		<tr>
			<td width="150" langkey="LK_DhcpOption60_VendorClassIDMode"></td>
			<td>
				<select name="SELECT_VendorClassIDMode" id="SELECT_VendorClassIDMode">
					<option value='Exact'>Exact</option>
					<option value='Prefix'>Prefix</option>
					<option value='Suffix'>Suffix</option>
					<option value='Substring'>Substring</option>
				</select>
			</td>
		</tr>		
		<tr>
			<td width="150" langkey="LK_DhcpOption60_MinAddress"></td>
			<td><input type="text" id="MinAddress" maxlength="128">
		</tr>
		<tr>
			<td width="150" langkey="LK_DhcpOption60_MaxAddress"></td>
			<td><input type="text" id="MaxAddress" maxlength="128">
		</tr>
		<tr>
			<td width="150" langkey="LK_DhcpOption60_DNSServer1"></td>
			<td><input type="text" id="DNSServer1" maxlength="128">
		</tr>
		<tr>
			<td width="150" langkey="LK_DhcpOption60_DNSServer2"></td>
			<td><input type="text" id="DNSServer2" maxlength="128">
		</tr>
		<tr>
			<td width="150" langkey="LK_DhcpOption60_SubnetMask"></td>
			<td><input type="text" id="SubnetMask" maxlength="128">
		</tr>
		<tr>
			<td width="150" langkey="LK_DhcpOption60_IPRouters"></td>
			<td><input type="text" id="IPRouters" maxlength="128">
		</tr>
		<tr>
			<td width="150" langkey="LK_DhcpOption60_DHCPLeaseTime"></td>
			<td><input type="text" id="DHCPLeaseTime" maxlength="128">
		</tr>

		<tr id="BUTTON_BLOCK" class="spaceLine"><td colspan="2">&nbsp;</td></tr>
		<tr>
			<td colspan="2">
			<script>PrintTriButton("back",getStr("LK_Back"),"uiBack();" );</script>
			<script>PrintTriButton("submit",getStr("LK_Apply"),"uiSubmit(op);" );</script>
			<script>PrintTriButton("refresh",getStr('LK_Refresh'),"uiPageRefresh()");</script>
			</td>
		</tr>
	</table>
</form>
<script>printEndContent();</script>
<form method="post" name="dataform" id="dataform" action="/cgi-bin/setup.cgi?page/basicsetup/basic_adddhcpoption60.shtml">
</form>
</body>
</html>
