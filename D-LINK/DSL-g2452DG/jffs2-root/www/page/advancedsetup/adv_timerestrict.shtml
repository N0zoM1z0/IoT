<html><head>
<link rel=stylesheet href='/css/content.css' type='text/css'>
<meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
<script language='javascript' src='/js/jquery.js'></script>
<script language='javascript' src='/js/check.js'></script>
<script language='javascript' src='/js/t_utils.js'></script>
<script language='javascript' src='/js/init.js'></script>
<script language='javascript' src='/js/tri.js'></script>
<script language='javascript' src='/js/project.js'></script>
<script language='javascript'>
<!-- hide
function TimeRestrictTuple()
{
	this.Path = ""
    this.username = ""
    this.macaddr = ""
    this.weekdays = ""
    this.timefrom = ""
    this.timeto = ""
}

var rulesNum = 0;
var restRules = new Array();
var timeRestrictEnable = '<!--#getsingle "InternetGatewayDevice.TimeRestriction.Enable" -->';
<!--#getobject "InternetGatewayDevice.TimeRestriction.RestRules. Username MACAddr WeekDays TimeFrom TimeTo" -->
	restRules[rulesNum] = new TimeRestrictTuple();
	restRules[rulesNum].Path = "<!--#path -->";
	restRules[rulesNum].username = "<!--#leaf  "1"-->";
	restRules[rulesNum].macaddr = "<!--#leaf  "2"-->";
	restRules[rulesNum].weekdays = "<!--#leaf  "3"-->";
	restRules[rulesNum].timefrom = "<!--#leaf  "4"-->";
	restRules[rulesNum].timeto = "<!--#leaf  "5"-->";
	rulesNum++;
<!--#endgetobject -->

function EditRules(idx){
	document.location.href = "adv_timerestrictadd.shtml?action=edit&idx=" + idx;
}

function DelRules(path) {
	if(!validateCode(2))
		return false;
	var df = document.timerestrict;
	AddElements(df, "del_obj", path);
	df.submit();
}

function addTimeRestrict() {
	if(rulesNum >= 16){
		top.AlertMsg(getStr("LK_TimeRuleLimit"));
		return false;
	}
	document.location.href = "adv_timerestrictadd.shtml?action=add";
}

var weekEnum = new Array("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat");
function parseWeekdays(week)
{
	var weekarray = "[";
	var daysofweek = weekEnum.length;
	for (var i = 0; i < daysofweek; i++)
	{
		if (week.indexOf(weekEnum[i]) != -1)
			weekarray += "1";
		else
			weekarray += "0";
		if (i < daysofweek - 1)
			weekarray += ",";
	}
	weekarray += "]";
	return weekarray;
}

function uiSubmit()
{
	if(!validateCode())
		return false;
	var df = document.timerestrict;
	AddElements(df, "InternetGatewayDevice.TimeRestriction.Enable", $("Enable_TimeRestrict").checked == true ? 1 : 0);
	df.submit();
}

function fillItems() {
	if(rulesNum == 0) {
		document.writeln('<tr class="OddRowB"><td colspan="13">' + getStr("LK_NoRule") + '</td></tr>');
		return;
	}
	for(var i=0; i< rulesNum; i++) {
		var weekarr = parseWeekdays(restRules[i].weekdays);
		var week = eval(weekarr);
		if(i%2 == 0)
			document.writeln("<tr class='OddRowB'>");
		else
			document.writeln("<tr class='EvenRowB'>");

		document.writeln("<td>&nbsp;"+ (i+1) + "</td>");
		document.writeln("<td>&nbsp;"+ restRules[i].username + "</td>");
		document.writeln("<td>&nbsp;"+ restRules[i].macaddr + "</td>");
		document.writeln("<td>&nbsp;"+ (week[0] == "1" ? '&radic;' : "") + "</td>"); // sun
		document.writeln("<td>&nbsp;"+ (week[1] == "1" ? '&radic;' : "") + "</td>"); // mon
		document.writeln("<td>&nbsp;"+ (week[2] == "1" ? '&radic;' : "") + "</td>"); // tue
		document.writeln("<td>&nbsp;"+ (week[3] == "1" ? '&radic;' : "") + "</td>"); // wed
		document.writeln("<td>&nbsp;"+ (week[4] == "1" ? '&radic;' : "") + "</td>"); // thu
		document.writeln("<td>&nbsp;"+ (week[5] == "1" ? '&radic;' : "") + "</td>"); // fri
		document.writeln("<td>&nbsp;"+ (week[6] == "1" ? '&radic;' : "") + "</td>"); // sat
		document.writeln("<td>&nbsp;"+ restRules[i].timefrom + "</td>");
		document.writeln("<td>&nbsp;"+ restRules[i].timeto + "</td>");
		document.writeln("<td><img href='#' src='/skin/edit.gif' style='cursor:pointer' onclick='EditRules(" + i + ")'>&nbsp;&nbsp;<img href='#' src='/skin/trash.gif' style='cursor:pointer' onclick='DelRules(\"" + restRules[i].Path + "\")'></td>");
		document.writeln("</tr>");
	}
}

function __init() {
    setValue("Enable_TimeRestrict", timeRestrictEnable);
    if(IsExistedFunction("project_init") == true)
        project_init(GetCurrentFileName());
}

// done hiding -->
</script>
</head>
<body>
<script>printBeginContent();</script>
<script>SetContentTitle(getStr('LK_TimeRestTitle'))</script>
<table class="ContentTableNoColor" cellpadding='0' cellspacing='0'>
	<tr>
		<td width="150" langkey="LK_TimeRestrictionEnable"></td>
		<td><input type="checkbox" id="Enable_TimeRestrict"></td>
	</tr>
</table>
<table class="ContentTableNoColor" cellspacing="0" cellpadding="0">
<tr id="BUTTON_BLOCK" class="spaceLine"><td>&nbsp;</td></tr>
<tr>
   <td colspan="2">
      <script>PrintTriButton("apply",getStr("LK_Apply"),onClick="uiSubmit();");</script>&nbsp;&nbsp;
	  <script>PrintTriButton("refresh",getStr("LK_Refresh"),"uiPageRefresh();" );</script>
   </td>
</tr>
<tr class="spaceLine"><td>&nbsp;</td></tr>
</table>
<table class="ContentTableNoColor" cellpadding='0' cellspacing='0'>
	<tr class="FlagText">
		<td langkey="LK_Max16Entrie"></td>
	</tr>
</table>
<form>
<table class="ContentBorder" cellpadding='0' cellspacing='0'>
   <tr class="TitleRow">
      <td langkey="LK_Number"></td>
      <td langkey="LK_UserName"></td>
      <td langkey="LK_MACAddress"></td>
      <td langkey="LK_Sunday"></td>
      <td langkey="LK_Monday"></td>
      <td langkey="LK_Tuesday"></td>
      <td langkey="LK_Wedesday"></td>
      <td langkey="LK_Thuesday"></td>
      <td langkey="LK_Friday"></td>
      <td langkey="LK_Saturday"></td>
      <td langkey="LK_Start"></td>
      <td langkey="LK_Stop"></td>
      <td langkey="LK_Action"></td>
   </tr>
   <script language="javascript">
   <!-- hide
		fillItems();
   //-->
   </script>
</table><br>
<table class="ContentTableNoColor" cellspacing="0" cellpadding="0">
<tr id="BUTTON_BLOCK2" class="spaceLine"><td>&nbsp;</td></tr>
<tr>
   <td>
      <script>PrintTriButton("submit",getStr("LK_Add"),onClick="addTimeRestrict();");</script>&nbsp;&nbsp;
   </td>
</tr>
</table>
</form>
<script>printEndContent();</script>
<form method="post" name ="timerestrict" action="/cgi-bin/setup.cgi?page/advancedsetup/adv_timerestrict.shtml">
</form>
</body>
</html>
