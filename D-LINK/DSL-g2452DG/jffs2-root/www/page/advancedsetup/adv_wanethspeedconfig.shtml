<html>
<head>
<meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>
<link rel="stylesheet" rev="stylesheet" href="/css/content.css" type="text/css">
<script language="javascript" src="/js/check.js"></script>
<script language="javascript" src="/js/config.js"></script>
<script language="javascript" src="/js/tri.js"></script>
<script language="javascript" src="/js/jquery.js"></script>
<script language="javascript" src="/js/init.js"></script>
<script language="javascript" src="/js/t_utils.js"></script>
<script language='javascript' src='/js/project.js'></script>
</head>
<script>

function ConnectionTuple()
{
	this.Enable = "";
	this.Status = "";
	this.Speed = "";
	this.Duplex = "";
}

var m=0;
var G_WanStatus = new Array();
<!--#getobject "InternetGatewayDevice.WANDevice.2.WANEthernetInterfaceConfig. Enable Status MaxBitRate DuplexMode" -->
		G_WanStatus[m] = new ConnectionTuple();
    G_WanStatus[m].Enable = "<!--#leaf "1"-->";
    G_WanStatus[m].Status = "<!--#leaf "2"-->";
	  G_WanStatus[m].Speed = "<!--#leaf "3"-->";
	  G_WanStatus[m].Duplex = "<!--#leaf "4"-->";
<!--#endgetobject -->


function uiSubmit()
{
	if(!validateCode())
		return false;
	var df = document.Adv_EthSpeedCfg;
	var i,k;
	for(i = 1,k=1; i<= G_WanStatus.length ;i++,k++)
	{
		if($("speed_"+k).selectedIndex == 0)
		{
			AddElements(df,"InternetGatewayDevice.WANDevice.2.WANEthernetInterfaceConfig."+"MaxBitRate", "Auto");
			AddElements(df,"InternetGatewayDevice.WANDevice.2.WANEthernetInterfaceConfig."+"DuplexMode", "Auto");
		}
		else if($("speed_"+k).selectedIndex == 3)
		{
			AddElements(df,"InternetGatewayDevice.WANDevice.2.WANEthernetInterfaceConfig."+"MaxBitRate", "1000");
			AddElements(df,"InternetGatewayDevice.WANDevice.2.WANEthernetInterfaceConfig."+"DuplexMode", "Full");
		}
		else
		{
			if($("speed_"+k).selectedIndex == 1)
				AddElements(df,"InternetGatewayDevice.WANDevice.2.WANEthernetInterfaceConfig."+"MaxBitRate", "10");
			else
				AddElements(df,"InternetGatewayDevice.WANDevice.2.WANEthernetInterfaceConfig."+"MaxBitRate", "100");
								
			if($("duplex_"+k).selectedIndex == 0)	
				AddElements(df,"InternetGatewayDevice.WANDevice.2.WANEthernetInterfaceConfig."+"DuplexMode", "Half");
			else	
				AddElements(df,"InternetGatewayDevice.WANDevice.2.WANEthernetInterfaceConfig."+"DuplexMode", "Full");
			
		}
	}
	SetButtonStatus("save","disabled");
	df.submit();
}

function SetTable()
{
	var i,k;
	var text1 = ["Auto"];
	var value1 = ["0"];
	var text2 = [ getStr('LK_HalfDuplex'), getStr('LK_FullDuplex')];
	var value2 = ["1","2"];


	for(var i = 0,k=1; i<G_WanStatus.length ;i++,k++)
	{
		if(G_WanStatus[i].Status == "Disabled" || G_WanStatus[i].Status == "NoLink")
			$('status_'+k).innerHTML = getStr('LK_Down');
		else
			$('status_'+k).innerHTML = getStr('LK_Up');
		
		if(G_WanStatus[i].Speed == "10")
			$('speed_'+ k).selectedIndex = 1;
		else if(G_WanStatus[i].Speed == "100")
			$('speed_'+ k).selectedIndex = 2;
		else if(G_WanStatus[i].Speed == "1000")
		{
			$('speed_'+ k).selectedIndex = 3;
			createOptions('duplex_'+k,text2,value2);
			$('duplex_'+ k).selectedIndex = 1;
			$('duplex_'+ k).disabled = true;
		}
		else
			$('speed_'+ k).selectedIndex = 0;

		if(G_WanStatus[i].Speed == "Auto")
		{
			createOptions('duplex_'+k,text1,value1);
			$('duplex_'+ k).selectedIndex = 0;
			$('duplex_'+ k).disabled = true;

		}
		else
		{
			
			createOptions('duplex_'+k,text2,value2);
			if(G_WanStatus[i].Duplex == "Full")
				$('duplex_'+ k).selectedIndex = 1;
			else
				$('duplex_'+ k).selectedIndex = 0;
		}

	}

}

function SetSpeed(idx)
{
	var text1 = ["Auto"];
	var value1 = ["0"];
	var text2 = [ getStr('LK_HalfDuplex'), getStr('LK_FullDuplex')];
	var value2 = ["1","2"];
	if($('speed_'+idx).selectedIndex == 0)
	{
		createOptions('duplex_'+idx, text1,value1);
		$('duplex_'+idx).disabled = true;
	}
	else if($('speed_'+idx).selectedIndex == 3)
	{		
		createOptions('duplex_'+idx, text2,value2);
		$('duplex_'+idx).selectedIndex = 1;
		$('duplex_'+idx).disabled = true;
	}
	else
	{
		createOptions('duplex_'+idx, text2,value2);
		$('duplex_'+idx).disabled = false;
	}

}

function createTable()
{
	var i , k ;
	for(i = 0,k=1; i < G_WanStatus.length ; i++ ,k++)
	{
		if(i%2==0)
		{
			document.write('<tr class="OddRowB">');
		}
		else
		{
			document.write('<tr class="EvenRowB">');
		}
		document.write('<td>'+getStr('LK_ETH')+'</td>');
		document.write('<td id="status_'+k+'"></td>');
		document.write('<td><select id="speed_'+k+'" onChange="SetSpeed('+k+')">');
		document.write('<option value="0">'+getStr('LK_Auto')+'</option><option value="1">'+getStr('LK_10MBS')+'</option><option value="2">'+getStr('LK_100MBS')+'</option><option value="3">'+getStr('LK_1000MBS')+'</option>');
		document.write('</select></td>');
		document.write('<td><select style="width:110px" id="duplex_'+k+'">');
		document.write('</select></td></tr>');
	}
	
}
function __init()
{
    SetTable();
    if(IsExistedFunction("project_init") == true) 
        project_init(GetCurrentFileName());         

}
</script>
<body>
<script>printBeginContent();</script>
<script>SetContentTitle(getStr("LK_WANEthModeCfg"));</script>
<form method="get">
	<table width="600" class="ContentBorder" cellspacing="0" cellpadding="0">
		<tr class="TitleRow">
			<td langkey="LK_Port"></td>
			<td langkey="LK_Status"></td>
			<td langkey="LK_Speed"></td>
			<td langkey="LK_Duplex"></td>
		</tr>
		<script>createTable()</script>
	</table>
	<table cellpadding="0" cellspacing="0" class="ContentTableNoColor">
		<tr id="BUTTON_BLOCK" class="spaceLine"><td>&nbsp;</td></tr>
		<tr><td>
		<script>PrintTriButton("save",getStr('LK_Apply'),"uiSubmit()");</script>&nbsp;
		<script>PrintTriButton("refresh",getStr('LK_Refresh'),"uiPageRefresh()")</script>
		</td></tr>
		
	</table>
</form>
<script>printEndContent();</script>
<form method="post" name="Adv_EthSpeedCfg" id="Adv_EthSpeedCfg" action="/cgi-bin/setup.cgi?page/advancedsetup/adv_wanethspeedconfig.shtml">
</form>
</body>
</html>
